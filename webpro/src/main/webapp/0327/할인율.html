<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style>
#result1, #result2 {
	display: flex;
	flex-direction: row;
	padding: 3px;
}

#result1 div, #result2 div {
	flex: 25%;
	margin: 2px;
	padding: 2px;
	background: lightgray;
}

img {
	width: 100%;
	height: 70%;
	cursor: pointer;
}
</style>
<script>
let ptag = null;

const proc1 = (vimg) => {
	// p태그를 지운다
	if(ptag != null) ptag.remove();
	
	// 랜덤발생 : 5 ~ 10; - textNode로 생성
	let rnd = Math.floor(Math.random() * 6 + 5);
	let txt = document.createTextNode("할인율 : " + rnd + "%");
	
	// p태그 생성
	ptag = document.createElement('p');
	
	// p태그에 textNode 추가
	ptag.appendChild(txt);
	
	// vimg의 부모노드에 p태그 추가
	vimg.parentNode.append(ptag);
	
	// 현재 이미지의 클릭이벤트를 삭제한다.
	vimg.removeAttribute("onclick");
	vimg.style.cursor = "default";
}

window.onload = function() {
	// result2의 이미지 검색
	img2 = document.querySelectorAll('#result2 img');
	
	// 반복문 사용
	for(let i=0; i<img2.length; i++) {
		img2[i].addEventListener('click', fn_listener)
	}
}

let ptag2 = null;

function fn_listener() {
	// this는 이미지를 지칭
	// event.target 사용 가능
	
	// ptag2를 지운다.
	if(ptag2 != null) ptag2.remove();
	
	let rnd = Math.floor(Math.random() * 6 + 5);
	let txt = document.createTextNode("할인율 : " + rnd + "%");
	
	ptag2 = document.createElement('p');
	
	ptag2.appendChild(txt);
	
	this.parentNode.append(ptag2);
	
	// 현재 이미지의 이벤트를 삭제
	this.removeEventListener('click', fn_listener);
	this.style.cursor = "default";
}
</script>
</head>
<body>
	<div class="box">
		<h3>이미지 클릭시 랜덤으로 5~10 값을 발생 <br>
		'할인율 : n%' 내용을 p태그를 생성하여<br>
		클릭한 이미지의 부모 div에 추가<br>
		한 번만 클릭이 되도록 하고 클릭시 이전 p태그는 삭제</h3>
		
		<div id="result1">
			<div><img onclick="proc1(this)" src="../images/jQuery.jpg" alt="jQuery.jpg"></div>
			<div><img onclick="proc1(this)" src="../images/JSP2_1.jpg" alt="JSP2_1.jpg"></div>
			<div><img onclick="proc1(this)" src="../images/Koala.jpg" alt="Koala.jpg"></div>
			<div><img onclick="proc1(this)" src="../images/국화1.jpg" alt="국화1.jpg"></div>
		</div>
	</div>
	
	<div class="box">
		<h3>이미지 클릭시 랜덤으로 5~10 값을 발생 <br>
		'할인율 : n%' 내용을 p태그를 생성하여<br>
		클릭한 이미지의 부모 div에 추가<br>
		한 번만 클릭이 되도록 하고 클릭시 이전 p태그는 삭제</h3>
		
		<div id="result2">
			<div><img src="../images/jQuery.jpg" alt="jQuery.jpg"></div>
			<div><img src="../images/JSP2_1.jpg" alt="JSP2_1.jpg"></div>
			<div><img src="../images/Koala.jpg" alt="Koala.jpg"></div>
			<div><img src="../images/국화1.jpg" alt="국화1.jpg"></div>
		</div>
	</div>
</body>
</html>